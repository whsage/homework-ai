# Word 和 PDF 导出功能说明

## 🎯 为什么添加 Word 和 PDF 格式？

针对**学生和家长**的实际需求，我们新增了 Word 和 PDF 导出格式：

### 📄 Word 格式 (.docx)
**适合人群**: 需要编辑和整理学习记录的用户

**优势**:
- ✅ 可以使用 Microsoft Word、WPS Office 等常见软件打开
- ✅ 支持编辑、添加批注、高亮重点
- ✅ 可以调整格式、字体、颜色
- ✅ 易于打印和分享
- ✅ 家长可以添加评语和建议

**使用场景**:
- 整理错题集
- 添加学习笔记
- 家长批注和反馈
- 制作学习档案

### 📕 PDF 格式 (.pdf)
**适合人群**: 需要分享和归档的用户

**优势**:
- ✅ 通用格式，任何设备都能打开
- ✅ 格式固定，不会乱码
- ✅ 适合打印和存档
- ✅ 文件小，易于分享
- ✅ 专业、正式的文档格式

**使用场景**:
- 分享给老师查看学习进度
- 发送给家长了解孩子学习情况
- 打印后装订成册
- 长期归档保存

## 🚀 如何使用

### 导出步骤

1. **进入"我的作业"页面**
2. **点击"管理"按钮**
3. **选择一个会话**（Word 和 PDF 暂不支持批量导出）
4. **点击"导出"按钮**
5. **选择 Word 或 PDF 格式**
6. **文件自动下载**

### 重要提示

⚠️ **Word 和 PDF 格式目前仅支持单个会话导出**
- 如果选择多个会话，这两个选项会显示为禁用状态
- 如需导出多个会话，请使用 JSON 或 Markdown 格式

## 📊 导出内容

### Word 文档包含：

```
标题：作业会话标题
─────────────────────

基本信息：
- 科目
- 创建时间
- 消息数量

对话记录：
👤 学生 - 时间
  [学生的问题或回答]
  [如有图片，显示图片链接]

🤖 AI导师 - 时间
  📊 分析
  [AI 的分析内容]
  
  💡 提示
  [AI 的提示内容]
  
  🎯 引导
  [AI 的引导内容]

─────────────────────
（重复对话记录）
```

### PDF 文档包含：

与 Word 类似的内容，但格式更加固定和专业。

**注意**: 由于 jsPDF 默认不支持中文字体，PDF 中的中文可能显示为英文标签（如 "Student"、"AI Tutor"）。如需完整中文支持，建议使用 Word 格式。

## 🎨 格式特点

### Word 文档特点
- 使用标准的 .docx 格式
- 清晰的层次结构
- 适当的间距和分隔线
- 支持表情符号（👤🤖📊💡🎯）
- 图片以链接形式显示

### PDF 文档特点
- A4 纸张大小
- 自动分页
- 标准字体和间距
- 适合打印

## 💡 使用建议

### 给学生的建议
1. **复习时**: 导出为 Word，添加自己的笔记和理解
2. **考前整理**: 导出为 PDF，打印重点内容
3. **错题本**: 导出 Word 后整理成错题集

### 给家长的建议
1. **了解进度**: 定期导出 PDF 查看孩子学习情况
2. **沟通工具**: 在 Word 文档中添加评语和鼓励
3. **存档记录**: 每月导出一次，建立学习档案

### 给老师的建议
1. **作业检查**: 学生可以导出 PDF 提交作业过程
2. **个性化辅导**: 查看学生的 AI 对话记录，了解思维过程
3. **教学反馈**: 根据导出内容调整教学方法

## 🔧 技术说明

### 使用的库
- **Word**: `docx` - 生成标准 .docx 文件
- **PDF**: `jspdf` - 生成 PDF 文件

### 文件命名规则
```
{会话标题}_{会话ID前8位}_{时间戳}.docx
{会话标题}_{会话ID前8位}_{时间戳}.pdf
```

示例:
```
数学作业_abc12345_1736611200000.docx
英语阅读_def67890_1736611200000.pdf
```

## ⚠️ 已知限制

1. **批量导出**: Word 和 PDF 暂不支持批量导出多个会话
2. **中文字体**: PDF 中的中文显示可能受限（使用英文标签）
3. **图片**: 仅显示图片链接，不嵌入实际图片
4. **文件大小**: 对话很多的会话可能生成较大的文件

## 🔮 未来改进计划

- [ ] 支持 PDF 中文字体
- [ ] 支持批量导出为 Word/PDF
- [ ] 在文档中嵌入实际图片
- [ ] 添加自定义模板选项
- [ ] 支持导出为 PowerPoint 格式
- [ ] 添加水印和页眉页脚

## 📚 相关文档

- [导出功能总览](./EXPORT_FEATURE.md)
- [使用指南](./EXPORT_GUIDE.md)

---

**版本**: 2.0.0  
**更新时间**: 2026-01-11  
**新增**: Word 和 PDF 导出格式
