# Word æ–‡ä»¶åµŒå…¥å›¾ç‰‡åŠŸèƒ½

## âœ… åŠŸèƒ½å·²å®ç°

Word å¯¼å‡ºç°åœ¨ä¼š**ç›´æ¥åµŒå…¥å›¾ç‰‡**åˆ°æ–‡æ¡£ä¸­ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºé“¾æ¥ï¼

## ğŸ¯ **æ”¹è¿›å†…å®¹**

### ä¹‹å‰
```
[å›¾ç‰‡] https://supabase.co/storage/v1/object/public/homework-images/...
```
- âŒ åªæ˜¾ç¤ºå›¾ç‰‡é“¾æ¥
- âŒ éœ€è¦æ‰‹åŠ¨ç‚¹å‡»é“¾æ¥æŸ¥çœ‹
- âŒ ç¦»çº¿æ— æ³•æŸ¥çœ‹å›¾ç‰‡

### ç°åœ¨
```
[å®é™…çš„å›¾ç‰‡åµŒå…¥åœ¨æ–‡æ¡£ä¸­]
```
- âœ… å›¾ç‰‡ç›´æ¥æ˜¾ç¤ºåœ¨æ–‡æ¡£ä¸­
- âœ… æ— éœ€ç½‘ç»œè¿æ¥
- âœ… å¯ä»¥ç›´æ¥æŸ¥çœ‹å’Œæ‰“å°

## ğŸ”§ **æŠ€æœ¯å®ç°**

### 1. æ·»åŠ  ImageRun å¯¼å…¥
```javascript
import { Document, Paragraph, TextRun, ImageRun, HeadingLevel, AlignmentType, Packer } from 'docx';
```

### 2. åˆ›å»ºå›¾ç‰‡ä¸‹è½½å‡½æ•°
```javascript
const fetchImageAsArrayBuffer = async (url) => {
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error('Failed to fetch image');
        return await response.arrayBuffer();
    } catch (error) {
        console.error('Error fetching image:', error);
        return null;
    }
};
```

### 3. åµŒå…¥å›¾ç‰‡åˆ°æ–‡æ¡£
```javascript
if (msg.imageUrl) {
    try {
        const imageBuffer = await fetchImageAsArrayBuffer(msg.imageUrl);
        if (imageBuffer) {
            docParagraphs.push(
                new Paragraph({
                    children: [
                        new ImageRun({
                            data: imageBuffer,
                            transformation: {
                                width: 400,  // å›¾ç‰‡å®½åº¦ï¼ˆåƒç´ ï¼‰
                                height: 300  // å›¾ç‰‡é«˜åº¦ï¼ˆåƒç´ ï¼‰
                            }
                        })
                    ],
                    spacing: { after: 200 }
                })
            );
        }
    } catch (error) {
        // å‡ºé”™æ—¶æ˜¾ç¤ºé“¾æ¥
        docParagraphs.push(/* é“¾æ¥æ–‡æœ¬ */);
    }
}
```

### 4. ä¿®å¤ async/await é—®é¢˜
```javascript
// ä¹‹å‰ï¼šforEach ä¸æ”¯æŒ async/await
messages.forEach((msg, index) => {
    await fetchImageAsArrayBuffer(msg.imageUrl);  // âŒ é”™è¯¯
});

// ç°åœ¨ï¼šä½¿ç”¨ for å¾ªç¯
for (let index = 0; index < messages.length; index++) {
    const msg = messages[index];
    await fetchImageAsArrayBuffer(msg.imageUrl);  // âœ… æ­£ç¡®
}
```

## ğŸ“Š **å›¾ç‰‡è®¾ç½®**

### å°ºå¯¸
- **å®½åº¦**ï¼š400 åƒç´ 
- **é«˜åº¦**ï¼š300 åƒç´ 
- **æ¯”ä¾‹**ï¼š4:3ï¼ˆé€‚åˆå¤§å¤šæ•°é¢˜ç›®å›¾ç‰‡ï¼‰

### ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªå°ºå¯¸ï¼Ÿ
- âœ… ä¸ä¼šå¤ªå¤§å ç”¨ç©ºé—´
- âœ… ä¸ä¼šå¤ªå°çœ‹ä¸æ¸…
- âœ… é€‚åˆ A4 çº¸å¼ æ‰“å°
- âœ… ä¿æŒæ¸…æ™°åº¦

### è‡ªå®šä¹‰å°ºå¯¸
å¦‚æœéœ€è¦è°ƒæ•´ï¼Œä¿®æ”¹è¿™é‡Œï¼š
```javascript
transformation: {
    width: 400,   // ä¿®æ”¹å®½åº¦
    height: 300   // ä¿®æ”¹é«˜åº¦
}
```

## ğŸ¨ **æ–‡æ¡£ç»“æ„**

### å®Œæ•´ç¤ºä¾‹
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        æ•°å­¦ä½œä¸š - é€Ÿåº¦è®¡ç®—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç§‘ç›®ï¼šæ•°å­¦
åˆ›å»ºæ—¶é—´ï¼š2026-01-12 21:26:55
æ¶ˆæ¯æ•°é‡ï¼š3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ‘¤ å­¦ç”Ÿ - 2026-01-12 21:26:55

[å®é™…çš„å›¾ç‰‡æ˜¾ç¤ºåœ¨è¿™é‡Œ]
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                     â”‚
 â”‚   é¢˜ç›®å›¾ç‰‡å†…å®¹      â”‚
 â”‚                     â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¯·å¸®æˆ‘åˆ†æè¿™é“é¢˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ¤– AIå¯¼å¸ˆ - 2026-01-12 21:27:14

ğŸ“Š åˆ†æ
è¿™æ˜¯ä¸€é“å…³äºé€Ÿåº¦ã€æ—¶é—´å’Œè·ç¦»çš„åº”ç”¨é¢˜...

ğŸ’¡ æç¤º
è¦åˆ¤æ–­æ˜¯å¦è¶…é€Ÿï¼Œéœ€è¦è®¡ç®—å®é™…å¹³å‡é€Ÿåº¦...

ğŸ¯ å¼•å¯¼
1. é¦–å…ˆè®¡ç®—å®é™…è¡Œé©¶çš„å¹³å‡é€Ÿåº¦
2. ç„¶åä¸æœ€é«˜é™é€Ÿæ¯”è¾ƒ
```

## ğŸ”„ **å®¹é”™æœºåˆ¶**

### å›¾ç‰‡ä¸‹è½½å¤±è´¥æ—¶
```javascript
if (imageBuffer) {
    // åµŒå…¥å›¾ç‰‡
} else {
    // æ˜¾ç¤ºé“¾æ¥ä½œä¸ºå¤‡é€‰
    docParagraphs.push(
        new Paragraph({
            children: [
                new TextRun({ text: '[å›¾ç‰‡] ', italics: true }),
                new TextRun({ text: msg.imageUrl, color: '0066CC' })
            ]
        })
    );
}
```

### å¯èƒ½å¤±è´¥çš„æƒ…å†µ
- âŒ ç½‘ç»œè¿æ¥é—®é¢˜
- âŒ å›¾ç‰‡ URL å¤±æ•ˆ
- âŒ CORS è·¨åŸŸé™åˆ¶
- âŒ å›¾ç‰‡æ ¼å¼ä¸æ”¯æŒ

### å¤±è´¥æ—¶çš„è¡¨ç°
- æ˜¾ç¤ºå›¾ç‰‡é“¾æ¥ï¼ˆè“è‰²æ–‡å­—ï¼‰
- ä¸ä¼šä¸­æ–­å¯¼å‡ºè¿‡ç¨‹
- å…¶ä»–å†…å®¹æ­£å¸¸æ˜¾ç¤º

## ğŸ“¦ **æ–‡ä»¶å¤§å°å½±å“**

### å¯¹æ¯”
| æƒ…å†µ | æ–‡ä»¶å¤§å° |
|------|---------|
| åªæœ‰é“¾æ¥ | ~20 KB |
| åµŒå…¥ 1 å¼ å›¾ç‰‡ | ~50-100 KB |
| åµŒå…¥ 5 å¼ å›¾ç‰‡ | ~200-400 KB |

### ä¼˜åŒ–å»ºè®®
- å›¾ç‰‡ä¼šè¢«å‹ç¼©
- ä½¿ç”¨åˆé€‚çš„å°ºå¯¸
- ä¸ä¼šå½±å“æ‰“å¼€é€Ÿåº¦

## ğŸ¯ **ä½¿ç”¨æ–¹æ³•**

### å¯¼å‡ºæ­¥éª¤
1. è¿›å…¥"æˆ‘çš„ä½œä¸š"é¡µé¢
2. é€‰æ‹©ä¸€ä¸ªä¼šè¯
3. ç‚¹å‡»"å¯¼å‡º" â†’ é€‰æ‹©"Word"
4. âœ… ä¸‹è½½åŒ…å«åµŒå…¥å›¾ç‰‡çš„ Word æ–‡æ¡£

### æ‰“å¼€æ–‡æ¡£
- **Windows**ï¼šMicrosoft Wordã€WPS Office
- **Mac**ï¼šMicrosoft Wordã€Pages
- **åœ¨çº¿**ï¼šGoogle Docsã€Office Online

## âœ¨ **ä¼˜åŠ¿**

### 1. ç¦»çº¿å¯ç”¨
- âœ… æ— éœ€ç½‘ç»œè¿æ¥
- âœ… å›¾ç‰‡æ°¸ä¹…ä¿å­˜åœ¨æ–‡æ¡£ä¸­
- âœ… ä¸æ‹…å¿ƒé“¾æ¥å¤±æ•ˆ

### 2. æ–¹ä¾¿æ‰“å°
- âœ… å›¾ç‰‡ç›´æ¥æ‰“å°
- âœ… æ— éœ€é¢å¤–æ“ä½œ
- âœ… å®Œæ•´çš„å­¦ä¹ è®°å½•

### 3. æ˜“äºåˆ†äº«
- âœ… å‘é€æ–‡æ¡£å³å¯
- âœ… æ¥æ”¶è€…ç›´æ¥æŸ¥çœ‹
- âœ… æ— éœ€é¢å¤–ä¸‹è½½å›¾ç‰‡

### 4. ä¸“ä¸šå¤–è§‚
- âœ… å›¾æ–‡å¹¶èŒ‚
- âœ… æ’ç‰ˆç¾è§‚
- âœ… é€‚åˆå½’æ¡£

## ğŸ” **æŠ€æœ¯ç»†èŠ‚**

### ImageRun API
```javascript
new ImageRun({
    data: ArrayBuffer,        // å›¾ç‰‡æ•°æ®
    transformation: {
        width: number,        // å®½åº¦ï¼ˆåƒç´ ï¼‰
        height: number        // é«˜åº¦ï¼ˆåƒç´ ï¼‰
    }
})
```

### æ”¯æŒçš„å›¾ç‰‡æ ¼å¼
- âœ… JPG/JPEG
- âœ… PNG
- âœ… GIF
- âœ… BMP

### æ•°æ®æµç¨‹
```
å›¾ç‰‡ URL
    â†“
fetch() ä¸‹è½½
    â†“
ArrayBuffer
    â†“
ImageRun åµŒå…¥
    â†“
Word æ–‡æ¡£
```

## âš ï¸ **æ³¨æ„äº‹é¡¹**

### 1. ç½‘ç»œè¦æ±‚
- å¯¼å‡ºæ—¶éœ€è¦ç½‘ç»œè¿æ¥ï¼ˆä¸‹è½½å›¾ç‰‡ï¼‰
- å¯¼å‡ºåçš„æ–‡æ¡£å¯ç¦»çº¿ä½¿ç”¨

### 2. å¯¼å‡ºæ—¶é—´
- æœ‰å›¾ç‰‡æ—¶ä¼šç¨æ…¢ï¼ˆéœ€è¦ä¸‹è½½ï¼‰
- æ¯å¼ å›¾ç‰‡çº¦ 1-2 ç§’
- ä¼šæ˜¾ç¤º"æ­£åœ¨å¯¼å‡º..."æç¤º

### 3. å›¾ç‰‡è´¨é‡
- ä¿æŒåŸå§‹è´¨é‡
- ä¸ä¼šé¢å¤–å‹ç¼©
- æ¸…æ™°åº¦è‰¯å¥½

## ğŸ‰ **æ€»ç»“**

Word å¯¼å‡ºåŠŸèƒ½ç°åœ¨æ›´åŠ å®Œå–„ï¼š

âœ… **å›¾ç‰‡ç›´æ¥åµŒå…¥** - æ— éœ€ç‚¹å‡»é“¾æ¥  
âœ… **ç¦»çº¿å¯ç”¨** - ä¸ä¾èµ–ç½‘ç»œ  
âœ… **æ–¹ä¾¿æ‰“å°** - å›¾æ–‡ä¸€ä½“  
âœ… **å®¹é”™æœºåˆ¶** - å¤±è´¥æ—¶æ˜¾ç¤ºé“¾æ¥  
âœ… **ä¸“ä¸šå¤–è§‚** - é€‚åˆå½’æ¡£å’Œåˆ†äº«

ä»"åªæœ‰é“¾æ¥"åˆ°"å›¾æ–‡å¹¶èŒ‚"ï¼ğŸ“„
